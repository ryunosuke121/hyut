# hyut - macOS メモアプリ 要件定義書

## 1. プロジェクト概要

### 背景
Raycast Memo を使用しているが、以下の不満がある：
- 無料プランではドキュメント数に制限がある 
- メモの管理（分類・検索・整理）が行いづらい

一方で、以下の体験は気に入っている：
- Markdownをレンダリングして表示できる
- グローバルショートカットでポップアップを起動し、素早く書いて閉じられる

これらの良い点を活かしつつ、不満点を解消する**自分専用のメモアプリ**を開発する。

### ゴール
- ドキュメント数の制限がない
- フォルダ・タグ・全文検索によるメモ管理が可能
- ショートカットで瞬時に起動・記入・終了できる快適な操作感

---

## 2. 技術スタック

| 項目 | 選定 | 理由 |
|------|------|------|
| フレームワーク | 要件に最適なものを選定（後述） | ユーザーは「おまかせ」を希望 |
| データ保存 | ローカル Markdown ファイル (.md) | 他ツール（VS Code, Obsidian等）でも編集可能。ポータビリティ重視 |
| メタデータ | YAML frontmatter | タグ・作成日時などをファイル内に埋め込み。ポータブル |

### 技術スタック

**推奨: Tauri + Web技術（React/Svelte + TypeScript）**
- macOSネイティブのウィンドウ制御が可能（フローティングウィンドウ、グローバルショートカット）
- Markdownエディタのライブラリが豊富（Web技術ベース）
- Rust バックエンドでファイルI/Oや検索が高速

## 3. 機能要件

### Phase 1: MVP（最小限の製品）

ショートカットで起動して、Markdownメモを書いて保存できる状態。

#### 3.1 グローバルショートカット起動
- macOS 全体で有効なキーボードショートカットでアプリを起動/トグルできる
- デフォルトショートカットキーは設定で変更可能

#### 3.2 フローティングウィンドウ
- 画面中央にポップアップ形式で表示
- 他のアプリの上にフロートする
- Escキーまたはウィンドウ外クリックで閉じる（非表示にする）
- ウィンドウサイズはリサイズ可能

#### 3.3 Markdownエディタ（リアルタイムプレビュー）
- WYSIWYG風のリアルタイムプレビューエディタ（Typora風）
- 書きながらMarkdownがレンダリングされる
- 対応する Markdown 記法:
  - 見出し（h1〜h6）
  - 太字・斜体・取り消し線
  - リスト（箇条書き・番号付き）
  - チェックボックス
  - コードブロック（シンタックスハイライト付き）
  - インラインコード
  - リンク
  - 画像（ローカルパス・URL）
  - 引用
  - テーブル
  - 水平線

#### 3.4 ファイル保存
- 保存先: 固定の1ディレクトリ（デフォルト: `~/hyut`）
- 保存先ディレクトリは設定で変更可能
- ファイル形式: `.md`（プレーンな Markdown + YAML frontmatter）
- 自動保存（入力停止後に自動的にファイルへ書き出す）
- ファイル名: タイトル（h1 or frontmatter title）ベースで自動生成

#### 3.5 メモの新規作成・一覧表示
- 新規メモの作成
- メモ一覧をサイドバーまたはリストで表示
- 起動時は前回の状態を復元（最後に開いていたメモ or 一覧画面）

---

### Phase 2: 管理機能

#### 3.6 フォルダ管理
- 保存先ディレクトリ内のサブフォルダ＝フォルダとして扱う
- フォルダの作成・名前変更・削除
- メモのフォルダ間移動
- サイドバーでフォルダツリー表示

#### 3.7 タグ機能
- YAML frontmatter の `tags` フィールドでタグ管理
- タグの追加・削除をUI上で行える
- タグ一覧の表示
- タグによるフィルタリング

```yaml
---
tags: [work, idea, project-x]
created: 2025-01-15T10:30:00
modified: 2025-01-15T14:20:00
---
```

#### 3.8 全文検索
- メモの内容を横断的に検索
- インクリメンタルサーチ（入力に応じてリアルタイムで結果表示）
- 検索結果にマッチ箇所のハイライト表示

---

### Phase 3: 将来的な拡張（スコープ外だが記録）

以下は現時点では不要だが、将来的に検討し得る機能:
- ダークモード対応（macOS連動）
- ピン留め（お気に入り）
- エクスポート機能（PDF/HTML）
- 画像のペースト・添付管理
- メモ間のリンク（Wiki-link）
- バージョン履歴
- iCloud同期

---

## 4. 非機能要件

### 4.1 パフォーマンス
- アプリ起動（ショートカットからウィンドウ表示まで）: 200ms 以内
- メモの保存: バックグラウンドで即座に実行
- 検索: 1000件のメモに対して100ms以内にレスポンス

### 4.2 データポータビリティ
- すべてのデータはローカルの Markdown ファイルとして保存
- YAML frontmatter は広く使われている形式に準拠
- 特定のアプリにロックインされない

### 4.3 プライバシー
- ネットワーク通信は行わない（完全オフライン動作）
- データは全てローカルに保存

### 4.4 UX
- macOS ネイティブの見た目・操作感に馴染むデザイン
- キーボードだけで主要な操作が完結できる

---

## 5. YAML frontmatter 仕様

すべてのメモファイルは以下の frontmatter を持つ:

```yaml
---
title: "メモのタイトル"
tags: []
created: 2025-01-15T10:30:00
modified: 2025-01-15T14:20:00
---
```

| フィールド | 型 | 必須 | 説明 |
|-----------|-----|------|------|
| title | string | Yes | メモのタイトル |
| tags | string[] | No | タグの配列 |
| created | ISO 8601 datetime | Yes | 作成日時（自動設定） |
| modified | ISO 8601 datetime | Yes | 最終更新日時（自動更新） |

---

## 6. 開発フェーズ

| フェーズ | 内容 | 目標 |
|---------|------|------|
| Phase 1 (MVP) | ショートカット起動、フローティングウィンドウ、Markdownエディタ、ファイル保存、メモ一覧、状態復元 | まず書ける状態にする |
| Phase 2 | フォルダ管理、タグ機能、全文検索 | メモを効率的に管理できる |
| Phase 3 | ダークモード、ピン留め、エクスポート等 | 必要に応じて随時追加 |
